`CONFIG REWRITE`命令重新写入以`redis.conf`文件为配置的服务器，

重写是以非常保守的方式进行的：

* 保留评论和原始redis.conf的整体结构。
* 如果选项已经存在于旧的redis.conf文件中，它将在相同位置（行数）被重写。
* 如果选项以前不存在，但设置为其默认值，则重写过程不会添加它。
* 如果选项以前不存在，但设置为非默认值，则将其追加到文件末尾。
* 未使用的行将被清空。比如，如果您以前有多个`save`指令，但当前的配置较少或没有，因为您禁用了RDB持久性，所有行将被清空。

`CONFIG REWRITE`功能也可以在某些情况下完全重新编写配置文件，如果原始配置文件不再存在的话。但是，如果服务器完全没有配置文件启动，`CONFIG REWRITE`只会返回错误。

## 原子重写过程

为了确保redis.conf文件始终保持一致，即在错误或崩溃时始终以旧文件或新文件结束，重写操作是通过一次`write(2)`调用执行的，该调用的内容足够大，至少和旧文件一样大。有时，还会添加额外的注释来填充，以确保生成的文件足够大，然后通过截断文件来移除末尾的填充内容。
