将指定的地理空间项（经度，纬度，名称）添加到指定的键中。数据以排序集合的方式存储在键中，可通过 `GEOSEARCH` 命令查询项。

该命令以标准格式x，y接受参数，因此经度必须在纬度之前指定。可以索引的坐标有一定的限制：非常接近极地的区域是不可索引的。

由EPSG:900913 / EPSG:3785 / OSGEO:41001 指定的确切限制如下：

* 有效的经度范围为-180到180度。
* 有效的纬度范围为-85.05112878到85.05112878度。

这个命令在用户试图索引超出指定范围的坐标时会报错。

**注意：**没有 **GEODEL** 命令，因为您可以使用 `ZREM` 命令来删除元素。Geo 索引结构只是一个有序集合。

## GEOADD 选项

`GEOADD`还提供以下选项：

* **XX**：仅更新已存在的元素。不添加新元素。
* **NX**：不更新已存在的元素。始终添加新元素。
* **CH**：将返回值从已添加的新元素数修改为已更改的总元素数（CH是*changed*的缩写）。更改的元素是指**已添加的新元素**和已存在的元素，它们的坐标已更新。因此，命令行中指定的元素如果与过去相同的分数，将不被计算。注意：通常，`GEOADD`的返回值仅计算已添加的新元素数。

注意：**XX**和**NX**选项是相互排斥的。

它是如何工作的？
---

排序集合的填充方式是使用一种称为[Geohash](https://en.wikipedia.org/wiki/Geohash)的技术。纬度和经度位被交错排列成一个独特的52位整数。我们知道，排序集合中的双精度分数可以表示一个52位的整数而不会失去精度。

此格式允许通过检查覆盖整个形状所需的1+8个区域来进行边界框和半径查询，并丢弃其外的元素。通过计算覆盖的盒子的范围，从排好序的集合得分的较低位中移除足够的比特，并计算每个区域在排序集合中的得分范围来查询。

它使用什么地球模型？

该模型假设地球是一个球体，因此使用Haversine公式来计算距离。这个公式在应用到地球时只是一个近似值，因为地球并不是一个完美的球体。
当用于社交网络和类似应用程序需要这种查询类型时，这些引入的误差不是问题。
然而，最坏情况下的误差可能高达0.5%，因此你可能会考虑其他适用于误差关键应用的系统。

@examples

```cli
GEOADD Sicily 13.361389 38.115556 "Palermo" 15.087269 37.502669 "Catania"
GEODIST Sicily Palermo Catania
GEORADIUS Sicily 15 37 100 km
GEORADIUS Sicily 15 37 200 km
```
