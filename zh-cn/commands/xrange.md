该命令返回与给定ID范围匹配的流条目。
范围由最小和最大ID指定。返回所有在两个指定ID之间或正好等于两个ID之一的条目（闭区间）。

`XRANGE`命令有许多应用：

* 在特定时间范围内返回项目。这是可能的，因为流ID与时间相关。
* 逐步迭代流，每次迭代只返回几个项目。但在语义上比`SCAN`函数系列更强大。
* 从流中获取单个条目，提供要获取的条目的ID两次：作为查询间隔的开始和结束。

命令还有一个相反顺序返回项目的互补命令，称为`XREVRANGE`，其余完全相同。

## `-` 和 `+` 特殊标识符ID

`-`和`+`特殊ID分别表示流中可能的最小ID和最大ID，因此以下命令将仅返回流中的每个条目：

```
> XRANGE somestream - +
1) 1) 1526985054069-0
   2) 1) "duration"
      2) "72"
      3) "event-id"
      4) "9"
      5) "user-id"
      6) "839248"
2) 1) 1526985069902-0
   2) 1) "duration"
      2) "415"
      3) "event-id"
      4) "2"
      5) "user-id"
      6) "772213"
... other entries here ...
```

`-`和`+`特殊ID分别表示最小和最大范围ID，然而它们更易于输入。

## 未完成的ID

流ID由两个部分组成，Unix毫秒时间戳和在同一毫秒内插入的条目的序列号。可以使用`XRANGE`指定ID的第一部分，即毫秒时间，例如以下示例中所示：

```
> XRANGE somestream 1526985054069 1526985055069
```

在这种情况下，`XRANGE`将自动用`-0`完成起始间隔，并用`-18446744073709551615`完成结束间隔，以返回所有在给定毫秒和另一个指定毫秒的结束之间生成的条目。这也意味着重复两次相同的毫秒，我们将获取在该毫秒内的所有条目，因为序列号范围将从零到最大值。

以如下方式使用`XRANGE`命令可以获取在指定时间范围内的项目。这在访问流的历史事件非常方便。

## 独占范围

默认情况下，范围是闭合的（包含），这意味着回复可以包含与查询的起始和结束区间匹配的条目。可以通过在ID前加上字符 `(` 来指定开放区间（排除）。这对于迭代流是很有用的，如下所述。

## 返回最大条目数

使用**COUNT**选项可以减少报告的条目数量。尽管看起来可能不太重要，但这是一个非常重要的功能，因为它可以模拟诸如“给我大于或等于以下条目”的操作。

```
> XRANGE somestream 1526985054069-0 + COUNT 1
1) 1) 1526985054069-0
   2) 1) "duration"
      2) "72"
      3) "event-id"
      4) "9"
      5) "user-id"
      6) "839248"
```

在上面的情况下，条目 `1526985054069-0` 存在，否则服务器会发送下一个条目。 使用 `COUNT` 也是为了使用 `XRANGE` 作为迭代器的基础。

## 迭代一个流

为了迭代流，我们可以按照以下步骤进行。假设我们每次迭代要获取两个元素。我们开始获取前两个元素，这是很简单的：

```
> XRANGE writers - + COUNT 2
1) 1) 1526985676425-0
   2) 1) "name"
      2) "Virginia"
      3) "surname"
      4) "Woolf"
2) 1) 1526985685298-0
   2) 1) "name"
      2) "Jane"
      3) "surname"
      4) "Austen"
```

然后，不要从“-”开始再次进行迭代，作为范围的起始，我们使用上一次“XRANGE”调用返回的*最后*一个条目的条目ID作为一个排他的间隔。

上一条记录的ID是 `1526985685298-0`，所以我们在前面加上一个'('，然后继续迭代：

```
> XRANGE writers (1526985685298-0 + COUNT 2
1) 1) 1526985691746-0
   2) 1) "name"
      2) "Toni"
      3) "surname"
      4) "Morrison"
2) 1) 1526985712947-0
   2) 1) "name"
      2) "Agatha"
      3) "surname"
      4) "Christie"
```

等等。最终，这将允许访问流中的所有条目。显然，我们可以从任何ID或特定时间开始迭代，提供给定的不完整的起始ID。此外，我们还可以通过提供结束ID或不完整ID（而不是`+`）来限制迭代到给定的ID或时间。

命令`XREAD`也可以迭代流。
命令`XREVRANGE`可以反向迭代流，从较高的ID（或时间）到较低的ID（或时间）。

### 与较早版本的Redis迭代

虽然 Redis 6.2 仅支持排他的范围区间，但在早期版本中仍然可以使用类似的流迭代模式。您可以通过与上述描述相同的方式从流中获取第一条数据来开始获取。

对于后续的调用，您需要以编程方式推进上次返回的最后一个条目的ID。大多数Redis客户端应该会对此细节进行抽象处理，但如果需要的话，也可以在应用程序中进行实现。在上面的示例中，这意味着将`1526985685298-0`的序列从0增加到1。因此，第二次调用将是：

```
> XRANGE writers 1526985685298-1 + COUNT 2
1) 1) 1526985691746-0
   2) 1) "name"
      2) "Toni"
...
```

同时，请注意，一旦最后一个ID中的序列部分等于18446744073709551615，您需要增加时间戳并重置序列部分为0。例如，将ID“1526985685298-18446744073709551615”增加为“1526985685299-0”。

应用“XREVRANGE”迭代流时，适用对称模式。唯一的区别是客户端需要对后续调用的ID递减。当将序列部分为0的ID递减时，时间戳需要减1，序列设置为18446744073709551615。

## 获取单个项目

如果你寻找 `XGET` 命令，会感到失望，因为实际上使用 `XRANGE` 是获取流中单个条目的有效方法。你只需要在 XRANGE 的参数中两次指定 ID 即可。

```
> XRANGE mystream 1526984818136-0 1526984818136-0
1) 1) 1526984818136-0
   2) 1) "duration"
      2) "1532"
      3) "event-id"
      4) "5"
      5) "user-id"
      6) "7782813"
```

## 关于流的附加信息

有关Redis Streams的更多信息，请查看我们的[Redis Streams简介文档](/topics/streams-intro)。

@examples

```cli
XADD writers * name Virginia surname Woolf
XADD writers * name Jane surname Austen
XADD writers * name Toni surname Morrison
XADD writers * name Agatha surname Christie
XADD writers * name Ngozi surname Adichie
XLEN writers
XRANGE writers - + COUNT 2
```
