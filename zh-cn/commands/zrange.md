返回存储在 `<key>` 的有序集合中指定范围的元素。

`ZRANGE`可以执行不同类型的范围查询：按索引（排名）查询、按分数查询或按词典顺序查询。

从Redis 6.2.0开始，该命令可以替代以下命令：`ZREVRANGE`，`ZRANGEBYSCORE`，`ZREVRANGEBYSCORE`，`ZRANGEBYLEX`和`ZREVRANGEBYLEX`。

## 常见行为和选项

元素的顺序从最低分到最高分。具有相同分数的元素按字典顺序排列。

可选的 `REV` 参数可反转排序顺序，所以元素按照从高到低的分数排序，并且当分数相同时，按照逆词典顺序解决。

可选的`LIMIT`参数可用于从匹配的元素中获取子范围（类似于SQL中的_SELECT LIMIT偏移量，计数_）。
负的`<count>`返回从`<offset>`开始的所有元素。请注意，如果`<offset>`很大，则需要遍历有序集合以获取到要返回的元素前的`<offset>`个元素，这可能会增加O(N)的时间复杂度。

可选的 `WITHSCORES` 参数会在命令的回复中补充返回元素的分数。返回的列表包含 `value1,score1,...,valueN,scoreN` 而不是 `value1,...,valueN`。客户端库可以自由返回更适合的数据类型（建议：一个包含 (value, score) 数组/元组的数组）。

## 索引范围

默认情况下，该命令执行索引范围查询。`<start>` 和 `<stop>` 参数表示从零开始的索引，其中 `0` 是第一个元素，`1` 是下一个元素，以此类推。这些参数指定一个**包含的范围**，所以例如，`ZRANGE myzset 0 1` 将返回排好序的集合的第一个和第二个元素。

索引也可以是负数，表示相对于有序集合末尾的偏移量，其中"-1"为有序集合的最后一个元素，"-2"为倒数第二个元素，依此类推。

超出范围的索引不会产生错误。

如果`<start>`大于有序集合的结束索引或`<stop>`，则返回一个空列表。

如果 `<stop>` 大于已排序集合的结束索引，Redis 将使用已排序集合的最后一个元素。

## 分数范围

当加上`BYSCORE`选项时，该命令的行为与`ZRANGEBYSCORE`相似，返回分数在`<start>`和`<stop>`之间的有序集合中的元素范围。

"<start>" 和 "<stop>" 可以分别表示负无穷和正无穷。这意味着你不需要知道排序集合中的最高分数或最低分数，就可以获取从某个分数开始或到某个分数结束的所有元素。

默认情况下，`<start>` 和 `<stop>` 指定的分数区间是闭区间（包括起止分数）。
通过在分数前加前缀 `(` 可以指定一个开区间（不包括起止分数）。

例如：

```
ZRANGE zset (1 5 BYSCORE
```

在这种情况下，将返回所有满足 `1 < score <= 5` 条件的元素：

```
ZRANGE zset (5 (10 BYSCORE
```

会返回所有 `5 < score < 10` 的元素（5和10不包括）。

## 反向范围

使用 `REV` 选项可以将排序集合反转，其中索引0为具有最高分数的元素。

默认情况下，`<start>` 必须小于或等于 `<stop>` 才能返回任何内容。
然而，如果选择了 `BYSCORE` 或 `BYLEX` 选项，`<start>` 是要考虑的最高分数，而 `<stop>` 是要考虑的最低分数，因此 `<start>` 必须大于或等于 `<stop>` 才能返回任何内容。

例如：

```
ZRANGE zset 5 10 REV
```

将返回在倒序索引的5和10之间的元素。

```
ZRANGE zset 10 5 REV BYSCORE
```

返回分数小于10且大于5的所有元素。

## 词汇排序范围

当使用 `BYLEX` 选项时，该命令的行为类似于 `ZRANGEBYLEX`，返回有序集合中在 `<start>` 和 `<stop>` 字典顺序闭区间内的元素范围。

请注意，词典排序依赖于所有元素具有相同的分数。当元素具有不同的分数时，回复是未指定的。

有效的`<start>`和`<stop>`必须以`(`或`[`开头，以指定范围间隔是排除还是包含的。

`<start>`和`<stop>`的特殊值`+`和`-`分别表示正无穷和负无穷字符串，因此例如命令`ZRANGE myzset - + BYLEX`保证返回排序集合中的所有元素，前提是所有元素具有相同的分值。

`REV`选项可以反转`<start>`和`<stop>`元素的顺序，其中`<start>`必须按字典顺序大于`<stop>`才能得到非空的结果。

### 字符串的词典比较

字符串被比作一个二进制字节数组进行比较。由于ASCII字符集的规定，这意味着通常情况下也可以按照字典的方式比较普通ASCII字符。然而，如果使用非纯ASCII字符串（例如，UTF8字符串），则不适用上述规则。

然而，用户可以对编码后的字符串应用变换，以便排序集合中插入的元素的第一部分按照用户对特定应用程序的要求进行比较。例如，如果我想以不区分大小写的方式添加要进行比较的字符串，但在查询时仍要获取真实的大小写，可以按以下方式添加字符串：

    ZADD autocomplete 0 foo:Foo 0 bar:BAR 0 zap:zap

由于每个元素中的第一个*规范化*部分（在冒号字符之前），我们强制进行给定的比较。然而，在使用`ZRANGE ... BYLEX`查询范围之后，应用程序可以向用户显示冒号之后的字符串的第二部分。

二进制比较的特性使得可以将有序集合用作通用索引，例如，元素的首部可以是一个64位大端数。由于大端数将最高位字节放在最初的位置，二进制比较将匹配数字比较的大小。这可以用于实现对64位值的范围查询。就像下面的示例中，在首个8字节之后，我们可以存储索引元素的值。

@examples

```cli
ZADD myzset 1 "one" 2 "two" 3 "three"
ZRANGE myzset 0 -1
ZRANGE myzset 2 3
ZRANGE myzset -2 -1
```

下面的示例使用`WITHSCORES`显示了命令始终返回一个数组，但这次数组被填充为 *element_1*, *score_1*, *element_2*, *score_2*, ..., *element_N*, *score_N*。

```cli
ZADD myzset 1 "one" 2 "two" 3 "three"
ZRANGE myzset 0 1 WITHSCORES
```

这个例子演示了如何按分数查询有序集合，排除值为 `1` 的元素，并且返回结果中的第二个元素：

```cli
ZADD myzset 1 "one" 2 "two" 3 "three"
ZRANGE myzset (1 +inf BYSCORE LIMIT 1 1
```
