该命令用于从接收命令的Redis集群节点的"已知节点"集合中删除指定节点，通过其节点ID进行指定。
换句话说，指定的节点将从接收命令的节点的"节点表"中删除。

因为在给定节点作为集群的一部分时，所有参与集群的其他节点都知道它，为了完全将一个节点从集群中移除，必须向所有剩余的节点发送`CLUSTER FORGET`命令，而不管它们是主节点还是从节点。

但是，该命令不能简单地从接收命令的节点的内部节点表中删除节点，它还实现了一个禁止列表，不允许同一个节点再次作为处理从其他节点接收到的心跳包的结果而被添加。

## 为什么需要禁止清单的细节

在下面的例子中，我们将展示为什么命令不仅仅应该从节点表中删除给定的节点，还应该在一段时间内防止其重新插入。

假设我们有四个节点，A、B、C和D。为了最终拥有只有三个节点的集群A、B、C，我们可以按照以下步骤操作：

1. 将所有哈希槽从D重新分配给节点A、B、C。
2. D现在为空，但仍在A、B和C的节点表中列出。
3. 我们联系A，并发送`CLUSTER FORGET D`。
4. B向节点A发送心跳包，其中列出了节点D。
5. A不再知道节点D（参见步骤3），因此它与D开始握手。
6. D重新添加到节点A的节点表中。

正如您所见，以这种方式移除节点是很脆弱的，我们需要尽快向所有节点发送`CLUSTER FORGET`命令，希望在此期间没有流言（gossip）部分正在处理。因为这个问题，该命令实现了一个带有过期时间的禁止列表。

所以，命令实际上是做什么的：

1. 从节点表中删除指定节点。
2. 被移除的节点 ID 将被添加到封禁列表中，封禁时间为 1 分钟。
3. 当节点从其他节点的心跳数据包中接收到八卦信息时，将跳过封禁列表中列出的所有节点 ID 进行处理。

这样我们就有60秒的时间窗口来通知集群中的所有节点我们想要移除一个节点。

# 不允许执行命令的特殊条件

命令在以下情况下执行失败并返回错误：


1. 在节点表中找不到指定的节点ID。
2. 接收命令的节点是副本，并且指定的节点ID标识其当前的主节点。
3. 节点ID标识的是我们正在发送命令的同一节点。
