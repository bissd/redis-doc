返回或存储在 `key` 键中的 [列表](tdtl)、[集合](tdts) 或 [有序集合](tdtss) 中包含的元素。

还有这个命令的只读变体 `SORT_RO`。

默认情况下，排序是数字排序，并按其值作为双精度浮点数进行比较。这是`SORT`的最简形式：

[tdtl]: /topics/data-types#lists
[tdts]: /topics/data-types#set
[tdtss]: /topics/data-types#sorted-sets

```
SORT mylist
```

假设 `mylist` 是一个数字列表，这个命令将返回相同的列表，其中的元素按从小到大的顺序排序。
要按从大到小排序数字，请使用 `!DESC` 修饰符：

```
SORT mylist DESC
```

当`mylist`包含字符串值，并且您想要按字典排序时，请使用`!ALPHA`修饰符：

```
SORT mylist ALPHA
```

Redis 是 UTF-8 能力的，假定您正确设置 `!LC_COLLATE` 环境变量。

返回的元素数量可以使用`!LIMIT`修饰符进行限制。
该修饰符接受`offset`参数，指定要跳过的元素数量，以及`count`参数，指定从`offset`开始返回的元素数量。
以下示例将返回`mylist`的排序版本中的10个元素，从元素0开始(`offset`基于零)：

```
SORT mylist LIMIT 0 10
```

几乎所有的修饰符都可以一起使用。
以下示例将返回前5个元素，按字典顺序降序排列：

```
SORT mylist LIMIT 0 5 ALPHA DESC
```

## 按照外部键排序

有时候您想要使用外部键作为权重来比较元素的排序，
而不是比较列表、集合或有序集合中的实际元素。
假设列表 `mylist` 包含元素 `1`、`2` 和 `3`，分别代表存储在 `object_1`、`object_2` 和 `object_3` 中的唯一对象的ID。
当这些对象与存储在 `weight_1`、`weight_2` 和 `weight_3` 中的权重关联时，可以使用以下语句指示 `SORT` 使用这些权重对 `mylist` 进行排序：

```
SORT mylist BY weight_*
```

`BY`选项接受一个模式（在本例中等于`weight_*`），用于生成用于排序的键。
这些键名通过将第一个出现的`*`替换为列表中元素的实际值（在本例中为`1`、`2`和`3`）来获得。

## 跳过排序元素

`!BY`选项还可以使用一个不存在的键，这会导致`SORT`跳过排序操作。如果您想在不进行排序操作的情况下检索外部键（请参见下面的`!GET`选项），这将非常有用。

```
SORT mylist BY nosort
```

## 获取外部键

我们之前的示例只返回了排序后的ID。
在某些情况下，获取实际的对象而不是它们的ID（`object_1`，`object_2`和`object_3`）更加有用。
根据列表、集合或有序集合中的元素检索外部键可以使用以下命令完成：

```
SORT mylist BY weight_* GET object_*
```

`!GET`选项可以多次使用，以获取原始列表、集合或有序集的每个元素的更多键。

还可以使用特殊模式`#`来获取元素本身:`!GET`。

```
SORT mylist BY weight_* GET object_* GET #
```

## 使用外部密钥的限制

在启用`Redis集群模式`时，无法保证外部键在处理命令的节点上存在。
在这种情况下，任何引用外部键模式的`GET`或`BY`命令将导致命令失败并出现错误。

从Redis 7.0开始，只有在当前用户具有完全键读取权限的情况下，才允许使用参考外部键模式的`GET`或`BY`命令。
可以通过为用户设置完全键读取权限，例如，使用相关命令访问规则指定`'%R~*'`或`'~*`来设置。
您可以查看`ACL SETUSER`命令手册，了解有关设置ACL访问规则的更多信息。
如果没有设置完全键读取权限，命令将失败并显示错误。

## 存储排序操作的结果

默认情况下，`SORT`将排序后的元素返回给客户端。
通过`!STORE`选项，结果将被存储为一个列表，而不是返回给客户端。

```
SORT mylist BY weight_* STORE resultkey
```

使用`SORT ... STORE`的有趣模式是将`EXPIRE`超时与结果键关联起来，这样在可以缓存`SORT`操作结果的应用程序中就可以缓存一段时间。
其他客户端将使用缓存列表而不是为每个请求调用`SORT`。
当键过期时，可以通过再次调用`SORT ... STORE`来创建缓存的更新版本。

请注意，为了正确实现这个模式，重要的是避免多个客户端同时重建缓存。
在这里需要一种锁定机制（例如使用`SETNX`）。

在`!BY`和`!GET`中使用哈希

可以使用以下语法对哈希字段使用 `!BY` 和 `!GET` 选项:

```
SORT mylist BY weight_*->fieldname GET object_*->fieldname
```

字符串->用于将键名与哈希字段名分离。
将键名替换为上述文档中记录的内容，然后访问存储在结果键中的哈希来检索指定的哈希字段。
