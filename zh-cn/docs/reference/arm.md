---
title: "ARM支持"
linkTitle: "ARM支持"
weight: 11
description: >
    在ARM CPU架构上探索Redis
aliases:
    - /topics/ARM
---

Redis 4.0 及以上版本通常支持 ARM 处理器和树莓派作为主要平台。每个新版本的 Redis 都在树莓派环境中进行测试，并在此文档页面中更新有关支持设备和其他有用信息的信息。虽然 Redis 可在 Android 上运行，但我们希望将来能够将测试工作扩展到 Android，以使其成为官方支持的平台。

我们认为Redis在物联网和嵌入式设备中具有几个优势：

* Redis具有非常小的内存占用和CPU需求。它可以在像树莓派Zero这样的小型设备上运行，不会影响整体性能，只使用少量内存，同时为许多用例提供良好的性能。
* Redis的数据结构常常是建模物联网/嵌入式用例的理想方式。一些例子包括累积时间序列数据，接收或排队要执行的命令或回应发送回远程服务器等等。
* 在Redis内建模数据可以非常有用，以便为必须非常快速响应或远程服务器离线时的设备做出决策。
* Redis可用作设备中运行的进程之间的通信系统。
* Redis的追加写入文件存储非常适合SSD卡。
* Redis 5.0及更高版本中包含的流数据结构专门为时间序列应用程序设计，具有非常低的内存开销。

## Redis /proc/cpu/alignment requirements

Redis中的/proc/cpu/alignment要求

Linux在ARM上允许捕获不对齐的访问并在内核中修复，以便继续执行有问题的程序，而不是生成`SIGBUS`。Redis 4.0及更高版本已经进行修复，以避免任何不对齐访问，因此不需要针对此内核配置设置特定值。即使将内核对齐修复设置为禁用，Redis也应该按预期运行。

## 在树莓派中构建Redis

* 下载Redis版本4.0或更高版本。
* 像往常一样使用 "make" 命令创建可执行文件。

在这个过程中没有什么特别之处。唯一的区别是，默认情况下，Redis使用`libc`分配器，而不是像在其他基于Linux的环境中默认使用`jemalloc`分配器。这是因为我们认为对于嵌入式设备内部的小规模用例，内存碎片化不太可能成为一个问题。此外，在ARM上使用`jemalloc`可能没有经过与`libc`分配器一样多的测试。

## 性能

在Raspberry Pi 3和Pi 1 model B上进行Redis性能测试。从性能方面来看，两种Pi之间的差异非常大。基准测试是通过回环接口进行的，因为大多数使用情况可能会从设备内部而不是通过网络使用Redis。以下是使用Redis 4.0获得的数字。

树莓派3：

* 测试1：500万写操作，100万个键（在键之间均匀分布）。无持久化，无流水线。每秒28,000次操作。
* 测试2：与测试1相似，但使用8个操作的流水线组：每秒80,000次操作。
* 测试3：与测试1相似，但启用AOF，fsync 1秒：每秒23,000次操作。
* 测试4：与测试3相似，但正在进行AOF重写：每秒21,000次操作。

## 樹莓派1型B模型:

**测试1**：500万次写入，使用100万个键（键均匀分布）。没有持久化，没有流水线处理。每秒2200个操作。

**测试2**：与测试1相似，但使用8个操作的流水线处理：每秒8500个操作。

**测试3**：与测试1相似，但启用AOF，每秒fsync 1次：每秒1820个操作。

**测试4**：与测试3相似，但正在进行AOF重写：每秒1000个操作。

上面的基准测试是针对简单的`SET`/`GET`操作。Redis的快速操作（非线性运行）性能在所有操作中类似。然而，有序集合可能会显示略慢一些的数字。
